{% extends 'workouts/base.html' %}

{% block content %}
<div class="container-fluid" style="max-width: 1200px;">
    <h1 class="text-3xl font-bold text-white mb-4">Workout Planner</h1>

    <form hx-post="{% url 'generate-plan' %}"
          hx-target="#results-container"
          hx-swap="innerHTML"
          hx-indicator="#loading-spinner">

        {% csrf_token %}

        <!-- SECTION 1: Base Workout Definition -->
        <div class="card bg-gray-800 border-gray-700 shadow-lg mb-4">
            <div class="card-header bg-gray-700 border-gray-600 text-white d-flex justify-content-between align-items-center">
                <span class="font-semibold">Step 1: Define the Base Workout</span>
                <div class="btn-group">
                    <button type="button" class="btn btn-sm btn-outline-info"
                            hx-get="{% url 'add-workout-segment' %}"
                            hx-target="#workout-items"
                            hx-swap="beforeend">
                        + Add Single Segment
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-warning"
                            hx-get="{% url 'add-repeat-block' %}"
                            hx-target="#workout-items"
                            hx-swap="beforeend">
                        + Add Repeat Block
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div id="workout-items" class="space-y-4">
                    {% include 'session_planner/partials/_workout_segment.html' %}
                </div>
            </div>
        </div>

        <!-- SECTION 2: Training Groups (A, B, C) -->
        <div class="card bg-gray-800 border-gray-700 shadow-lg mb-4">
            <div class="card-header bg-gray-700 border-gray-600 text-white font-semibold">
                Step 2: Define Training Groups
            </div>
            <div class="card-body">
                <div class="row g-3">
                    {% for char in "abc"|make_list %}
                    <div class="col-md-4">
                        <div class="p-3 bg-gray-700 rounded-lg shadow-inner">
                            <h6 class="text-white">Group {{ char|upper }}</h6>
                            <input type="text" name="group_{{ char }}_name" class="form-control form-control-sm bg-gray-600 border-gray-500 text-white mb-2" value="Group {{ char|upper }}">
                            <select name="group_{{ char }}_metric" class="form-select form-select-sm bg-gray-600 border-gray-500 text-white mb-2">
                                <option value="vdot">VDOT</option>
                                <option value="5k_time">5k Time</option>
                            </select>
                            <input type="text" name="group_{{ char }}_value" class="form-control form-control-sm bg-gray-600 border-gray-500 text-white" placeholder="VDOT or HH:MM:SS" required>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="d-grid">
            <button type="submit" class="btn btn-primary btn-lg">Generate Differentiated Plan</button>
        </div>
    </form>

    <div id="results-container" class="mt-5"></div>
</div>
{% endblock %}